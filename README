This directory is a code and data archive for
Extending Ensemble Kalman Filter Algorithms to Assimilate Observations with an Unknown Time Offset
by Elia Gorokhovsky and Jeffrey L. Anderson
Submitted to Nonlinear Processes in Geophysics


All the data used for the final version of this study can be generated by the matlab
scripts in this directory. Versions of the figure files generated by the scripts are also here.

These scripts can select 7 cases but only 5 are used in the paper, each associated with an integer:
11. The base case that does no correction,
12. A case doing the standard correction for time offset, also referred to as the Possible Correction,
13. Variance only correction,
14. The impossible correction using exact knowledge of the observation,
29. The nonlinear correction.

The case is selected in the scripts by assigning a variable at the head of each script.

The data generation proceeds as follows:

1. Run tuning_runs.m to generate the files tuning_out_11, etc. These runs explore the assimilation
quality for a set of inflation and localization values.

2. Run find_best_tuning.m to create a file with the parameters of the tuning run with 
the best rmse for each case to generate the files best_tuning_out_11, etc.

3. Run multi_case_assimilation.m to do ten cases for each of the best tuning values
for all experiments. This generates the files multi_case_out_11, etc.

The first figure is generated with time_series_plot.m and generates an output file obs_time_series.png.
The remaining figures are generated by plot_trials.m and generate a total of 10 output files,
five each for the state error and the time offset error for the 5 different cases and for 5 
different observing networks. A subset of these files are included in the manuscript.


